<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="stylesheets/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <!-- <link rel="stylesheet icon" href="assets/logo.png"> -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <title>
      AlMARI | Online Shopping in Pakistan: Fashion, Electronics & Groceries
    </title>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const token = localStorage.getItem("token"); // Assuming the token is stored in localStorage

        if (!token) {
          console.warn("No token found, user is not authenticated.");
          return;
        }

        let userId;

        try {
          const response = await fetch("http://localhost:5000/api/users/me", {
            method: "GET",
            headers: {
              Authorization: `Bearer ${token}`,
            },
          });

          if (response.ok) {
            const userData = await response.json();
            userId = userData._id;
            console.log(userData);

            // Populate form fields (if needed)
            document.getElementById("email").value = userData.email;
            document.getElementById("fname").value =
              userData.name.split(" ")[0]; // Assuming first name is the first part of `name`
            document.getElementById("lname").value =
              userData.name.split(" ")[1] || ""; // Last name is the second part if available
            document.getElementById("address").value = userData.address;
            document.getElementById("city").value = userData.city;
            document.getElementById("state").value = userData.province || "";
            document.getElementById("postal").value = userData.pcode || "";
            document.getElementById("phone").value = userData.contact || "";
          } else {
            const errorData = await response.json();
            console.error("Failed to load user data:", errorData.message);
            return;
          }
        } catch (error) {
          console.error("An error occurred while fetching user data:", error);
          return;
        }

        document
          .querySelector("#primary-button")
          .addEventListener("click", async (e) => {
            e.preventDefault();

            if (!userId) {
              alert("User not found. Please log in.");
              return;
            }

            // Ensure `cart` is defined and accessible
            if (typeof cart === "undefined") {
              console.error("Cart is not defined.");
              return;
            }

            // Create the products array based on the cart
            const products = cart.map((item) => ({
              productId: item.id, // Ensure the ID is passed as productId
              quantity: item.quantity,
              price: item.price,
            }));

            const orderData = {
              email: document.getElementById("email").value,
              firstName: document.getElementById("fname").value,
              lastName: document.getElementById("lname").value,
              address: document.getElementById("address").value,
              city: document.getElementById("city").value,
              state: document.getElementById("state").value,
              postalCode: document.getElementById("postal").value,
              phone: document.getElementById("phone").value,
              products: cart.map((item) => ({
                productId: item.id,
                name: item.name, // Ensure the product name is available in your cart items
                price: item.price,
                quantity: item.quantity,
                image: item.image, // Ensure the image URL is available in your cart items
              })),
              totalAmount: calculateTotal(),
              orderNotes: "", // Add order notes if needed
            };

            try {
              const response = await fetch("http://localhost:5000/api/orders", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                  Authorization: `Bearer ${token}`, // Include the token in the request
                },
                body: JSON.stringify(orderData),
              });

              if (response.ok) {
                const newOrder = await response.json();
                // Display the custom order ID in the alert

                // Clear the cart
                localStorage.removeItem("cart");
                localStorage.removeItem("itemNum");
                setTimeout(() => {
                  location.href = "index.html";
                }, 1500);
                // Redirect or update the UI accordingly
              } else {
                const errorData = await response.json();
                console.error("Failed to place order:", errorData.message);
                alert("Failed to place order. Please try again.");
              }
            } catch (error) {
              console.error(
                "An error occurred while placing the order:",
                error
              );
            }
          });
        function calculateTotal() {
          // Calculate the total amount based on the cart
          return cart.reduce(
            (sum, item) => sum + item.price * item.quantity,
            0
          );
        }
      });
    </script>
  </head>
  <body>
    <div id="alert-box" class="alert-box"></div>

    <div id="page" class="site page-checkout">
      <!-- header Start  -->
      <aside class="site-off desktop-hide">
        <div class="off-canvas">
          <div class="canvas-head flexitem">
            <div class="logo">
              <a href="/"><img src="assets/logo/logo.png" alt="" /></a>
            </div>
            <a href="#" class="t-close flexcenter"
              ><i class="ri-close-line"></i
            ></a>
          </div>
          <div class="departments"></div>
          <nav class=""></nav>
          <div class="thetop-nav"></div>
        </div>
      </aside>
      <header>
        <div class="header-top mobile-hide">
          <div class="conrainer">
            <div class="wrapper flexitem">
              <div class="left">
                <ul class="flexitem main-link">
                  <li><a href="#">Blog</a></li>
                  <li><a href="#">Featured Products</a></li>
                  <li><a href="#">Wishlist</a></li>
                </ul>
              </div>
              <div class="right">
                <ul class="flexitem main-link">
                  <li id="signup"><a href="signup.html">Sign Up</a></li>
                  <li id="login"><a href="login.html">Login</a></li>
                  <li id="myAccount">
                    <a href="user.html">My Account</a>
                  </li>
                  <li id="myOrders">
                    <a href="orders.html">My Orders</a>
                  </li>
                  <li>
                    <a href="#"
                      >PKR
                      <span class="icon-small"
                        ><i class="ri-arrow-down-s-line"></i></span
                    ></a>
                    <ul>
                      <li class="current"><a href="#">PKR</a></li>
                      <li><a href="#">USD</a></li>
                      <li><a href="#">EURO</a></li>
                      <li><a href="#">GBP</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="#"
                      >English
                      <span class="icon-small"
                        ><i class="ri-arrow-down-s-line"></i></span
                    ></a>
                    <ul>
                      <li class="current"><a href="#">English</a></li>
                      <li><a href="#">Spanish</a></li>
                      <li><a href="#">German</a></li>
                      <li><a href="#">Bahasa</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="header-nav">
          <div class="container">
            <div class="wrapper flexitem">
              <a href="#" class="trigger desktop-hide"
                ><span class="i ri-menu-2-line"></span
              ></a>
              <div class="left flexitem">
                <div class="logo">
                  <a href="/"><img src="assets/logo/logo.png" alt="" /></a>
                </div>
                <nav class="mobile-hide">
                  <ul class="flexitem second-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="categoreis.html">Shop</a></li>
                    <li><a href="#">Men</a></li>
                    <li class="has-child">
                      <a href="#"
                        >Women
                        <div class="icon-small">
                          <i class="ri-arrow-down-s-line"> </i>
                        </div>
                      </a>
                      <div class="mega">
                        <div class="container">
                          <div class="wrapper">
                            <div class="flexcol">
                              <div class="row">
                                <h4>Women's Clothing</h4>
                                <ul>
                                  <li><a href="#">Dresses</a></li>
                                  <li><a href="#">Tops & Tees</a></li>
                                  <li><a href="#">Jackets & Coats</a></li>
                                  <li><a href="#">Pants & Capris</a></li>
                                  <li><a href="#">Sweaters</a></li>
                                  <li><a href="#">Costumes</a></li>
                                  <li><a href="#">Hoodies & Sweatshir</a></li>
                                  <li><a href="#">Pajamas & Robes</a></li>
                                  <li><a href="#">Shorts</a></li>
                                  <li><a href="#">Swimwear</a></li>
                                </ul>
                              </div>
                            </div>
                            <div class="flexcol">
                              <div class="row">
                                <h4>Jewelry</h4>
                                <ul>
                                  <li><a href="#">Accessories</a></li>
                                  <li><a href="#">Bags & Purses</a></li>
                                  <li><a href="#">Rings</a></li>
                                  <li><a href="#">Earrings</a></li>
                                  <li><a href="#">Bracelets</a></li>
                                  <li><a href="#">Body Jewelry</a></li>
                                </ul>
                              </div>
                            </div>
                            <div class="flexcol">
                              <div class="row">
                                <h4>Beauty</h4>
                                <ul>
                                  <li><a href="#">Bath Accessories</a></li>
                                  <li><a href="#">Makeup & Cosmetics</a></li>
                                  <li><a href="#">Skin Care</a></li>
                                  <li><a href="#">Hair Care</a></li>
                                  <li><a href="#">Fragrances</a></li>
                                  <li><a href="#">Essential Oils</a></li>
                                  <li><a href="#">Soaps & Bath Bombs</a></li>
                                  <li>
                                    <a href="#">Face Masks & Coverings</a>
                                  </li>
                                  <li><a href="#">Spa Kits & Gifts</a></li>
                                </ul>
                              </div>
                            </div>
                            <div class="flexcol products">
                              <div class="row">
                                <div class="meida">
                                  <div class="thumbnail object-cover">
                                    <a href="page-offer.html">
                                      <img
                                        src="assets/products/apparel4.jpg"
                                        alt=""
                                      />
                                    </a>
                                  </div>
                                </div>
                                <div class="text-content">
                                  <h4>Most Wanted!</h4>
                                  <a
                                    href="page-offer.html"
                                    class="primary-button"
                                    >Order Now!</a
                                  >
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </li>
                    <li>
                      <a href="#"
                        >Sports
                        <div class="fly-item"><span>New!</span></div>
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
              <div class="right">
                <ul class="flexitem second-links">
                  <li class="mobile-hide">
                    <a href="#">
                      <div class="icon-large">
                        <i class="ri-heart-line"></i>
                      </div>
                      <div class="fly-item">
                        <span class="item-number">0</span>
                      </div>
                    </a>
                  </li>
                  <li class="iscart">
                    <a href="cart.html">
                      <div class="icon-large shop">
                        <i class="ri-shopping-cart-line"></i>
                        <div class="fly-item">
                          <span id="itemnumber" class="item-number">0</span>
                        </div>
                      </div>
                      <div class="icon-text">
                        <div class="mini-text">Total</div>
                        <div class="cart-total" id="cart-totl">PKR 12,099</div>
                      </div>
                    </a>

                    <div class="mini-cart">
                      <div class="content">
                        <div class="cart-head">5 items in cart</div>
                        <div class="cart-body">
                          <ul class="products mini">
                            <li class="item">
                              <div class="thumbnail object-cover">
                                <a href="#"
                                  ><img src="assets/products/home2.jpg" alt=""
                                /></a>
                              </div>
                              <div class="item-content">
                                <p>
                                  <a href="#">Dimmable Ceiling Light Modern</a>
                                </p>
                                <span class="price">
                                  <span>PKR 1,999</span>
                                  <span class="fly-item"><span>2x</span></span>
                                </span>
                              </div>
                              <a href="" class="item-remove"
                                ><i class="ri-close-line"></i
                              ></a>
                            </li>
                            <li class="item">
                              <div class="thumbnail object-cover">
                                <a href="#"
                                  ><img
                                    src="assets/products/apparel1.jpg"
                                    alt=""
                                /></a>
                              </div>
                              <div class="item-content">
                                <p><a href="#">Under Armour Men's Tech</a></p>
                                <span class="price">
                                  <span>PKR 1,750</span>
                                  <span class="fly-item"><span>2x</span></span>
                                </span>
                              </div>
                              <a href="" class="item-remove"
                                ><i class="ri-close-line"></i
                              ></a>
                            </li>
                            <li class="item">
                              <div class="thumbnail object-cover">
                                <a href="#"
                                  ><img
                                    src="assets/products/apparel3.jpg"
                                    alt=""
                                /></a>
                              </div>
                              <div class="item-content">
                                <p><a href="#">Black Women's Coat Dress</a></p>
                                <span class="price">
                                  <span>PKR 1,350</span>
                                  <span class="fly-item"><span>2x</span></span>
                                </span>
                              </div>
                              <a href="" class="item-remove"
                                ><i class="ri-close-line"></i
                              ></a>
                            </li>
                            <li class="item">
                              <div class="thumbnail object-cover">
                                <a href="#"
                                  ><img
                                    src="assets/products/electronic3.jpg"
                                    alt=""
                                /></a>
                              </div>
                              <div class="item-content">
                                <p>
                                  <a href="#"
                                    >Wireless Headphones over Ear, Bluetooth
                                    Headphones</a
                                  >
                                </p>
                                <span class="price">
                                  <span>PKR 3,500</span>
                                  <span class="fly-item"><span>2x</span></span>
                                </span>
                              </div>
                              <a href="" class="item-remove"
                                ><i class="ri-close-line"></i
                              ></a>
                            </li>
                            <li class="item">
                              <div class="thumbnail object-cover">
                                <a href="#"
                                  ><img src="assets/products/shoe1.jpg" alt=""
                                /></a>
                              </div>
                              <div class="item-content">
                                <p>
                                  <a href="#"
                                    >Men Slip On Shoes Casual With Arch Support
                                    Insoles</a
                                  >
                                </p>
                                <span class="price">
                                  <span>PKR 3,500</span>
                                  <span class="fly-item"><span>2x</span></span>
                                </span>
                              </div>
                              <a href="#" class="item-remove"
                                ><i class="ri-close-line"></i
                              ></a>
                            </li>
                          </ul>
                        </div>
                        <div class="cart-footer">
                          <div class="subtotal">
                            <p>Subtotal</p>
                            <p><strong>PKR 12,099</strong></p>
                          </div>
                          <div class="actions">
                            <a href="checkout.html" class="primary-button"
                              >Checkout</a
                            >
                            <a href="cart.html" class="secondary-button"
                              >View Cart</a
                            >
                          </div>
                        </div>
                      </div>
                    </div>
                  </li>
                  <li class="userli">
                    <a href="user.html" class="user" id="user"></a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="header-main mobile-hide">
          <div class="container">
            <div class="wrapper flexitem">
              <div class="left">
                <div class="dpt-cat">
                  <div class="dpt-head">
                    <div class="main-text">All Departments</div>
                    <div class="mini-text mobile-hide">Total 1089 Products</div>
                    <a href="#" class="dpt-trigger mobile-hide">
                      <i class="ri-menu-3-line ri-xl"></i>
                    </a>
                  </div>
                  <div class="dpt-menu">
                    <ul class="second-links">
                      <li class="has-child beauty">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-bear-smile-line"></i>
                          </div>
                          Beauty
                          <div class="icon-small">
                            <i class="ri-arrow-right-s-line"></i>
                          </div>
                        </a>
                        <ul>
                          <li><a href="#">Makeup</a></li>
                          <li><a href="#">Skin Care</a></li>
                          <li><a href="#">Hair Care</a></li>
                          <li><a href="#">Fragrances</a></li>
                          <li><a href="#">Foot & Hand Care</a></li>
                          <li><a href="#">Tools & Accessories</a></li>
                          <li><a href="#">Shave & Hair Removel</a></li>
                          <li><a href="#">Personal Care</a></li>
                        </ul>
                      </li>
                      <li class="has-child electronic">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-bluetooth-connect-line"></i>
                          </div>
                          Electronic
                          <div class="icon-small">
                            <i class="ri-arrow-right-s-line"></i>
                          </div>
                        </a>
                        <ul>
                          <li><a href="#">Camera</a></li>
                          <li><a href="#">Call Phones</a></li>
                          <li><a href="#">Computers</a></li>
                          <li><a href="#">GPS & Navigation</a></li>
                          <li><a href="#">Headphones</a></li>
                          <li><a href="#">Home Audio</a></li>
                          <li><a href="#">Television</a></li>
                          <li><a href="#">Video Projectors</a></li>
                        </ul>
                      </li>
                      <li class="has-child fashion">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-t-shirt-air-line"></i>
                          </div>
                          Women's Fashion
                          <div class="icon-small">
                            <i class="ri-arrow-right-s-line"></i>
                          </div>
                        </a>
                        <ul>
                          <li><a href="#">Clothing</a></li>
                          <li><a href="#">Shoes</a></li>
                          <li><a href="#">Jewelry</a></li>
                          <li><a href="#">Watches</a></li>
                          <li><a href="#">Handgags</a></li>
                          <li><a href="#">Accessories</a></li>
                        </ul>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-shirt-line"></i>
                          </div>

                          Men's Fashion
                        </a>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-user-5-line"></i>
                          </div>

                          Girl's Fashion
                        </a>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-user-6-line"></i>
                          </div>

                          Boy's Fashion
                        </a>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-heart-pulse-line"></i>
                          </div>

                          Heath & Household
                        </a>
                      </li>
                      <li class="has-child homekit">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-home-8-line"></i>
                          </div>
                          Home & Kitchen
                          <div class="icon-small">
                            <i class="ri-arrow-right-s-line"></i>
                          </div>
                        </a>
                        <div class="mega">
                          <div class="flexcol">
                            <div class="row">
                              <h4><a href="#">Kitchen & Dining</a></h4>
                              <ul>
                                <li><a href="#">Kitchen</a></li>
                                <li><a href="#">Dining room</a></li>
                                <li><a href="#">Pantry</a></li>
                                <li><a href="#">Great room</a></li>
                                <li><a href="#">Breakfast Nook</a></li>
                              </ul>
                            </div>
                            <div class="row">
                              <h4><a href="#">Living</a></h4>
                              <ul>
                                <li><a href="#">Living Room</a></li>
                                <li><a href="#">Family room</a></li>
                                <li><a href="#">Sunroom</a></li>
                              </ul>
                            </div>
                          </div>
                          <div class="flexcol">
                            <div class="row">
                              <h4><a href="#">Bed & Bath</a></h4>
                              <ul>
                                <li><a href="#">Bathroom</a></li>
                                <li><a href="#">Bedroom</a></li>
                                <li><a href="#">Storage & Closet</a></li>
                                <li><a href="#">Baby & Kids</a></li>
                              </ul>
                            </div>
                            <div class="row">
                              <h4><a href="#">Utility</a></h4>
                              <ul>
                                <li><a href="#">Laundry</a></li>
                                <li><a href="#">Gurage</a></li>
                                <li><a href="#">Mudroom</a></li>
                              </ul>
                            </div>
                          </div>
                          <div class="flexcol">
                            <div class="row">
                              <h4><a href="#">Outdoor</a></h4>
                              <ul>
                                <li><a href="#">Landscape</a></li>
                                <li><a href="#">Patio</a></li>
                                <li><a href="#">Deck</a></li>
                                <li><a href="#">Pool</a></li>
                                <li><a href="#">Backyard</a></li>
                                <li><a href="#">Porch</a></li>
                                <li><a href="#">Exterior</a></li>
                                <li><a href="#">Outdoor Kitchen</a></li>
                                <li><a href="#">Front Yard</a></li>
                                <li><a href="#">Driveway</a></li>
                                <li><a href="#">Poolhouse</a></li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-android-line"></i>
                          </div>
                          Pet & Supplies
                        </a>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-basketball-line"></i>
                          </div>
                          Sports
                        </a>
                      </li>
                      <li class="has-child">
                        <a href="#">
                          <div class="icon-large">
                            <i class="ri-shield-star-line"></i>
                          </div>
                          Best Seller
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="right">
                <div class="search-box">
                  <form action="" class="search">
                    <span class="icon-large"
                      ><i class="ri-search-line"></i
                    ></span>
                    <input
                      type="search"
                      placeholder="Search for products"
                      class="search"
                    />
                    <button type="submit">Search</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- header end  -->
      <!-- Main Start  -->
      <main>
        <div class="single-checkout">
          <div class="container">
            <div class="wrapper">
              <div class="checkout flexwrap">
                <div class="item left styled">
                  <h1>Shipping Address</h1>
                  <form id="checkoutForm">
                    <p>
                      <label for="email">Email Address <span></span></label>
                      <input type="email" name="email" id="email" required />
                    </p>
                    <p>
                      <label for="fname">First Name <span></span></label>
                      <input type="text" name="firstName" id="fname" required />
                    </p>
                    <p>
                      <label for="lname">Last Name <span></span></label>
                      <input type="text" name="lastName" id="lname" required />
                    </p>
                    <p>
                      <label for="address">Street Address <span></span></label>
                      <input type="text" name="address" id="address" required />
                    </p>
                    <p>
                      <label for="city">City <span></span></label>
                      <input type="text" name="city" id="city" required />
                    </p>
                    <p>
                      <label for="state">State/Province <span></span></label>
                      <input type="text" name="state" id="state" required />
                    </p>
                    <p>
                      <label for="postal">Postal Code <span></span></label>
                      <input
                        type="number"
                        name="postalCode"
                        id="postal"
                        required
                      />
                    </p>
                    <p>
                      <label for="phone">Phone Number <span></span></label>
                      <input type="number" name="phone" id="phone" required />
                    </p>
                    <p>
                      <label>Order Notes (optional)</label>
                      <textarea
                        name="orderNotes"
                        cols="30"
                        rows="10"
                      ></textarea>
                    </p>
                    <div class="shipping-methods">
                      <h2>Shipping Methods</h2>
                      <h3 style="color: #ff3333">
                        *We only do Cash On Delivery for now
                      </h3>
                      <p class="checkset">
                        <input
                          type="radio"
                          name="shippingMethod"
                          value="200"
                          checked
                        />
                        <label>PKR 200 Flat Rate</label>
                      </p>
                    </div>
                    <div class="primary-checkout">
                      <input
                        type="submit"
                        onclick="showAlert('your order has been placed')"
                        value="Place Order"
                        class="primary-button"
                        id="primary-button"
                      />
                    </div>
                  </form>
                </div>
                <div class="item right">
                  <h2>Order Summary</h2>
                  <div class="summary-order is_sticky">
                    <div class="summary-totals">
                      <ul>
                        <span>TOTAL</span>
                        <span id="tt">PKR </span>
                      </ul>
                    </div>
                    <ul class="products mini" id="checkoutprod">
                      <li class="item" id="item">
                        <div class="thumbnail object-cover">
                          <img src="assets/products/home2.jpg" alt="" />
                        </div>
                        <div class="item-ontent">
                          <p>Dimmable Ceiling Light Modern</p>
                          <span class="price">
                            <span>PKR 1,999</span>
                            <span>x 2</span>
                          </span>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
      <!-- Main end  -->
      <!-- Footer Start -->
      <footer>
        <div class="newsletter">
          <div class="container">
            <div class="wrapper">
              <div class="box">
                <div class="content">
                  <h3>Join to our newsletter</h3>
                  <p>
                    Get e-mail updates about our latest shop and
                    <strong>special offers.</strong>
                  </p>
                </div>
                <form action="" class="search">
                  <span class="icon-large">
                    <ri class="ri-mail-line"></ri>
                  </span>
                  <input
                    type="mail"
                    placeholder="Your Email Address"
                    required
                  />
                  <button type="submit">Sign Up</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <div class="widgets">
          <div class="container">
            <div class="wrapper">
              <div class="flexwrap">
                <div class="row">
                  <div class="item mini-links">
                    <h4>Help & Contact</h4>
                    <ul class="flexcol">
                      <li><a href="#">Your Accounts</a></li>
                      <li><a href="#">Your Orders</a></li>
                      <li><a href="#">Returns</a></li>
                      <li><a href="#">Shipping Rates</a></li>
                      <li><a href="#">Assistant</a></li>
                      <li><a href="#">Heip</a></li>
                      <li><a href="#">Contact Us</a></li>
                    </ul>
                  </div>
                </div>
                <div class="row">
                  <div class="item mini-links">
                    <h4>Products Categories</h4>
                    <ul class="flexcol">
                      <li><a href="#">Beauty</a></li>
                      <li><a href="#">Electronic</a></li>
                      <li><a href="#">Women's fashion</a></li>
                      <li><a href="#">Men's fashion</a></li>
                      <li><a href="#">Boy's fashion</a></li>
                      <li><a href="#">Girl's fashion</a></li>
                      <li><a href="#">Health & Household</a></li>
                      <li><a href="#">Home & Kitchen</a></li>
                      <li><a href="#">Pet Supplies</a></li>
                      <li><a href="#">Sports</a></li>
                    </ul>
                  </div>
                </div>
                <div class="row">
                  <div class="item mini-links">
                    <h4>Payment Info</h4>
                    <ul class="flexcol">
                      <li><a href="#">Business card</a></li>
                      <li><a href="#">Shop With Points</a></li>
                      <li><a href="#">reload Your Balance</a></li>
                      <li><a href="#">Stripe</a></li>
                    </ul>
                  </div>
                </div>
                <div class="row">
                  <div class="item mini-links">
                    <h4>About Us</h4>
                    <ul class="flexcol">
                      <li><a href="#">Company Info</a></li>
                      <li><a href="#">News</a></li>
                      <li><a href="#">Investors</a></li>
                      <li><a href="#">Career</a></li>
                      <li><a href="#">Politics</a></li>
                      <li><a href="#">Customer Reviews</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="footer-info">
          <div class="container">
            <div class="wrapper">
              <div class="flexcol">
                <div class="logo footer-logo">
                  <a href="/"><img src="assets/logo/logo.png" alt="" /></a>
                </div>
                <div class="socials">
                  <ul class="flexitem">
                    <li>
                      <a href=""><i class="ri-twitter-line"></i></a>
                    </li>
                    <li>
                      <a href=""><i class="ri-facebook-line"></i></a>
                    </li>
                    <li>
                      <a href=""><i class="ri-instagram-line"></i></a>
                    </li>
                    <li>
                      <a href=""><i class="ri-linkedin-line"></i></a>
                    </li>
                    <li>
                      <a href=""><i class="ri-youtube-line"></i></a>
                    </li>
                  </ul>
                </div>
              </div>
              <p class="mini-text">
                Copyright 2024 © AlMARI all rights reserved.
              </p>
            </div>
          </div>
        </div>
      </footer>
      <!-- Footer end -->
      <div class="menu-buttom desktop-hide">
        <div class="container">
          <div class="wrapper">
            <nav>
              <ul class="flexitem">
                <li>
                  <a href="#">
                    <i class="ri-bar-chart-line"></i>
                    <span>Trending</span>
                  </a>
                </li>
                <li>
                  <a href="#">
                    <i class="ri-user-6-line"></i>
                    <span>Account</span>
                  </a>
                </li>
                <li>
                  <a href="#">
                    <i class="ri-heart-line"></i>
                    <span>Wishlist</span>
                  </a>
                </li>
                <li>
                  <a href="#0" class="t-search">
                    <i class="ri-search-line"></i>
                    <span>search</span>
                  </a>
                </li>
                <li>
                  <a href="#0" class="cart-trigger">
                    <i class="ri-shopping-cart-line"></i>
                    <span>Cart</span>
                    <div class="fly-item">
                      <span class="item-number">0</span>
                    </div>
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>

      <div class="search-bottom desktop-hide">
        <div class="container">
          <div class="wrapper">
            <form action="" class="search">
              <a href="#" class="t-close search-close flexcenter"
                ><i class="ri-close-line"></i
              ></a>
              <span class="icon-large"><i class="ri-search-line"></i></span>
              <input
                type="search"
                placeholder="Search for products"
                class="search"
              />
              <button type="submit">Search</button>
            </form>
          </div>
        </div>
      </div>
      <div class="overlay"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fslightbox/3.3.1/index.js"></script>
  </body>
</html>
<script>
  if (!localStorage.getItem("cart")) {
    alert("Please fill out the cart first!");
    location.href = "categoreis.html";
  }
  document
    .getElementById("checkoutForm")
    .addEventListener("submit", function (event) {
      event.preventDefault();

      if (localStorage.getItem("cart")) {
        const formData = {
          email: document.getElementById("email").value,
          firstName: document.getElementById("fname").value,
          lastName: document.getElementById("lname").value,
          address: document.getElementById("address").value,
          city: document.getElementById("city").value,
          state: document.getElementById("state").value,
          postalCode: document.getElementById("postal").value,
          phone: document.getElementById("phone").value,
          orderNotes: document.querySelector('textarea[name="orderNotes"]')
            .value,
          products: JSON.parse(localStorage.getItem("cart")), // Make sure cart items are correctly formatted
          totalAmount: calculateTotalAmount(), // Implement this function to calculate total
        };

        fetch("http://127.0.0.1:5000/api/orders", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(formData),
        })
          .then((response) => response.json())
          .then((data) => {
            alert("Your order has been successfully processed");
            localStorage.removeItem("itemNum"); // Handle successful response, e.g., show a success message or redirect
            localStorage.removeItem("cart");
            // Handle successful response, e.g., show a success message or redirect
            location.href = "categoreis.html";
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      } else {
        alert("Your cart is empty. Please add items to proceed with checkout.");
      }
    });

  function calculateTotalAmount() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    return cart.reduce(
      (total, item) => total + item.price * (item.quantity || 1),
      0
    );
  }
</script>
<script src="scripts/script.js"></script>
